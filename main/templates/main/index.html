{% extends 'main/base.html' %}

{% block title %}
Home
{% endblock %}

{% load staticfiles %}
{% block content %}

<div class="container">
    <div class="card">
        <div class="card-body">
            <h3 class="text-center">Welcome to Irrigation Simulation</h3>
            <div class="row">
                <div class="col-md-8">
                    <img src="{% static 'img/step1.jpg' %}" id="dynamicImage" alt="" class="img-fluid" width="600">

                </div>
                <div class="col-md-4">
                    <h3 class="text-center">Controller</h3>
                    <div class="text-center">
                        <a href="#" class="btn btn-success" onclick="loader();">Start Simulation</a>
                        <br>
                        <br><a href="#" class="btn btn-danger" id="click">Stop Simulation</a>
                    </div>
                    <div class="text-left">
                        <br><br>
                        <h4>Current Moisture Level</h4>
                        <div class="row">
                            <div class="col-md-4">Field 1: <h4 id="text">0%</h4></div>
                            <div class="col-md-4">Field 2: <h4 id="text2">0%</h4></div>
                            <div class="col-md-4">Field 3: <h4 id="text3">0%</h4></div>
                        </div>
                        
                    </div>
                    <br>
                    <div class="text-right">
                        <a href="{% url 'accounts:logout_user' %}" class="btn btn-primary">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>



var counter = 0;
var state = 1;

// identifier for which label to updates
var change = 1;

function changeImage(){

    images = ["http://ec2-3-14-152-181.us-east-2.compute.amazonaws.com/images/irrigation.jpg ",
             "http://ec2-3-14-152-181.us-east-2.compute.amazonaws.com/images/irrigation_3.jpg ",
              "http://ec2-3-14-152-181.us-east-2.compute.amazonaws.com/images/irrigation_2.jpg ",
               "http://ec2-3-14-152-181.us-east-2.compute.amazonaws.com/images/irrigation_1.jpg "]

    percents = ["0%", "20%", "40%", "60%", "80%", "100%"]

    var image = document.getElementById("dynamicImage");
    var text = document.getElementById("text")
    var text2 = document.getElementById("text2")
    var text3 = document.getElementById("text3")

    if (change == 1){
        text.innerHTML = percents[counter];
    }
    else if(change == 2){
        text2.innerHTML = percents[counter];
    }

    else if(change == 3){

        text3.innerHTML = percents[counter];
    }

    // divisible by 5 to verify its five seconds
    if (counter % 5 == 0){
        // change the imge
        image.src = images[state];
        
        if (state == 3){
            state = 0;
        }
        state ++;
    }
    if (counter == 5){

        // set counter to 0
        counter = 0;
        if (change==3){
            change = 0;
        }
        change ++;
    }
    
    counter ++;
}

    function loader() {

        myLoad = setInterval(changeImage, 1000);

        var click = document.getElementById("click");
        click.onclick = function () {
            clearInterval(myLoad);
            flag = false;
        }

    };






</script>


{% endblock %}