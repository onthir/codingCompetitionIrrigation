{% extends 'main/base.html' %}

{% block title %}
Home
{% endblock %}

{% load staticfiles %}
{% block content %}

<div class="container">
    <div class="card">
        <div class="card-body">
            <h3 class="text-center">Welcome to Irrigation Simulation</h3>
            <div class="row">
                <div class="col-md-8">
                    <img src="{% static 'img/step1.jpg' %}" id="dynamicImage" alt="" class="img-fluid" width="600">

                </div>
                <div class="col-md-4">
                    <h3 class="text-center">Controller</h3>
                    <div class="text-center">
                        <a href="#" class="btn btn-success" onclick="loader();">Start Simulation</a>
                        <br>
                        <br><a href="#" class="btn btn-danger" id="click">Stop Simulation</a>
                    </div>
                    <div class="text-left">
                        <br><br>
                        <h4>Current Moisture Level</h4>
                        <h4 id="text">0%</h4>
                    </div>
                    <br>
                    <div class="text-right">
                        <a href="{% url 'accounts:logout_user' %}" class="btn btn-primary">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

var counter = 0;
var state = 0;
function changeImage(){

    images = ["http://ec2-3-14-152-181.us-east-2.compute.amazonaws.com/images/irrigation.jpg ",
             "http://ec2-3-14-152-181.us-east-2.compute.amazonaws.com/images/irrigation_3.jpg ",
              "http://ec2-3-14-152-181.us-east-2.compute.amazonaws.com/images/irrigation_2.jpg ",
               "http://ec2-3-14-152-181.us-east-2.compute.amazonaws.com/images/irrigation_1.jpg "]

    percents = ["0%", "20%", "40%", "60%", "80%", "100%"]

    var image = document.getElementById("dynamicImage");
    var text = document.getElementById("text")

    text.innerHTML = percents[counter];
    if (counter % 5 == 0){
        // change the imge
        image.src = images[state];
        if (state == 3){
            state = 0;
        }
        state ++;
    }
    if (counter == 5){

        // set counter to 0
        counter = 0;
    }
    
    counter ++;
}

    function loader() {

        myLoad = setInterval(changeImage, 1000);

        var click = document.getElementById("click");
        click.onclick = function () {
            clearInterval(myLoad);
            flag = false;
        }

    };






</script>


{% endblock %}